import{j as e}from"./index-Znf7Ene3.js";import{r as S}from"./router-DP1sdCM0.js";import"./react-gH-7aFTg.js";const t={HOS:"HOS",VM:"Vehicle Maintenance",DA:"Controlled Substances/Alcohol",DF:"Driver Fitness",UD:"Unsafe Driving",CI:"Crash Indicator",HZ:"Hazmat"},T=[{id:"cred-1",section:"Credentials & Registration",type:"tf",text:"T/F: Your MCS-150 must be reviewed and updated on a scheduled basis even if nothing changed.",choices:["True","False"],correct:[0],weight:1,basicTag:[t.UD]},{id:"cred-2",section:"Credentials & Registration",type:"single",text:"Which filing proves you have a process agent in all states?",choices:["MCS-90","BOC-3","UCR","IFTA"],correct:[1],weight:1,basicTag:[t.UD]},{id:"cred-3",section:"Credentials & Registration",type:"single",text:"Which combination best demonstrates interstate authority for for-hire carriers?",choices:["USDOT only","MC + BOC-3 + insurance filing","IFTA only","IRP only"],correct:[1],weight:1,basicTag:[t.UD]},{id:"dq-1",section:"Driver Qualification",type:"multi",text:"Which items must be in every DQF? (Select all)",choices:["Prior employer inquiries","Current MVR","Medical certificate","Road test or equivalent","Annual review"],correct:[0,1,2,3,4],weight:2,basicTag:[t.DF]},{id:"dq-2",section:"Driver Qualification",type:"single",text:"You hire a CDL driver. What must be done with the FMCSA Clearinghouse before allowing safety-sensitive work?",choices:["Annual limited query","Pre-employment full query","Post-accident log","Random test"],correct:[1],weight:2,basicTag:[t.DF,t.DA]},{id:"dq-3",section:"Driver Qualification",type:"tf",text:"T/F: You can wait 60 days after hire to obtain the driver’s prior employer responses.",choices:["True","False"],correct:[1],weight:1,basicTag:[t.DF]},{id:"da-1",section:"Drug & Alcohol",type:"multi",text:"Select all that trigger post-accident testing requirements under FMCSA (company policy must mirror CFR):",choices:["Tow-away","Citation issued and injury treated away from scene","Any airbag deployment","Fatality"],correct:[0,1,3],weight:2,basicTag:[t.DA,t.CI]},{id:"da-2",section:"Drug & Alcohol",type:"multi",text:"What belongs in a compliant random testing program? (Select all)",choices:["Written policy","Random selection method","Documented notifications","Follow-up/SAP tracking when applicable"],correct:[0,1,2,3],weight:2,basicTag:[t.DA]},{id:"da-3",section:"Drug & Alcohol",type:"tf",text:"T/F: Supervisors who make reasonable-suspicion decisions must receive required training.",choices:["True","False"],correct:[0],weight:1,basicTag:[t.DA]},{id:"hos-1",section:"HOS & ELD",type:"single",text:"A driver loses ELD connectivity for part of a day. What’s the correct response?",choices:["Keep driving, ignore gaps","Manual paper RODS per procedure until fixed, annotate, repair timeline","Wait for back-office to edit"],correct:[1],weight:3,basicTag:[t.HOS]},{id:"hos-2",section:"HOS & ELD",type:"single",text:"Short-haul exception requires (pick best set):",choices:["Timecards + duty radius + max duty hours + return to reporting location","ELD off + no records"],correct:[0],weight:3,basicTag:[t.HOS]},{id:"hos-3",section:"HOS & ELD",type:"tf",text:"T/F: All edits to ELD records require annotations and driver certification.",choices:["True","False"],correct:[0],weight:2,basicTag:[t.HOS]},{id:"vm-1",section:"Vehicle Maintenance",type:"multi",text:"Which are required elements of a systematic maintenance program? (Select all)",choices:["Unit files with inspection/repair records","Annual inspection proofs","DVIR handling","OOS repair sign-off"],correct:[0,1,2,3],weight:3,basicTag:[t.VM]},{id:"vm-2",section:"Vehicle Maintenance",type:"tf",text:"T/F: If a DVIR has no defects noted (and you’re on the “no-defect DVIR” allowance), you still must keep it per your retention policy.",choices:["True","False"],correct:[0],weight:2,basicTag:[t.VM]},{id:"acc-1",section:"Accidents & Incident Management",type:"multi",text:"What must be in your accident register? (Select all)",choices:["Date","City/State","Driver name","Injuries/Fatalities","Hazardous material spill","Preventability decision"],correct:[0,1,2,3,4],weight:2,basicTag:[t.CI]},{id:"acc-2",section:"Accidents & Incident Management",type:"text",text:"Scenario: Tow-away crash with a citation to your driver. What D&A steps are required?",choices:[],correct:[],weight:1,basicTag:[t.CI,t.DA]},{id:"hz-1",section:"Hazardous Materials",type:"single",text:"Who needs in-depth security plan training?",choices:["Any shipper","Only carriers with placardable quantities per regs","Nobody"],correct:[1],weight:2,basicTag:[t.HZ]},{id:"hz-2",section:"Hazardous Materials",type:"multi",text:"Pick compliant shipping paper elements (Select all)",choices:["Proper shipping name","UN/NA number","Hazard class","Packing group (if applicable)","Emergency phone"],correct:[0,1,2,3,4],weight:2,basicTag:[t.HZ]},{id:"sm-1",section:"Safety Management & Training",type:"multi",text:"Which items show an effective safety management control system? (Select all)",choices:["Written policy","Orientation + recurrent training","Documented coaching/corrective action","Trend reviews"],correct:[0,1,2,3],weight:1,basicTag:[t.UD]},{id:"sms-1",section:"CSA/SMS Understanding",type:"single",text:"A spike in Vehicle Maintenance BASIC most likely points to issues with:",choices:["Speeding","Lighting/brakes/DVIR","Hours edits","Prior employer checks"],correct:[1],weight:2,basicTag:[t.VM]},{id:"sms-2",section:"CSA/SMS Understanding",type:"single",text:"Best first steps after receiving multiple “unassigned driving time” ELD alerts?",choices:["Ignore","Assign/annotate, coach drivers, tighten yard moves policy"],correct:[1],weight:2,basicTag:[t.HOS]}],D={[t.VM]:25,[t.HOS]:25,[t.DA]:15,[t.DF]:15,[t.UD]:10,[t.CI]:10,[t.HZ]:0};function R(g){return["Credentials & Registration","Driver Qualification","Drug & Alcohol","HOS & ELD","Vehicle Maintenance","Accidents & Incident Management",...g?["Hazardous Materials"]:[],"Safety Management & Training","CSA/SMS Understanding"]}function A(g,c){const r={},h={};for(const s of T){if(!c&&s.section==="Hazardous Materials")continue;const o=g[s.id],f=s.weight||1;let b=!1;if(s.type==="tf"||s.type==="single")b=Array.isArray(o)&&o.length===1&&o[0]===s.correct[0];else if(s.type==="multi"){const u=new Set(o||[]),p=new Set(s.correct);b=u.size===p.size&&[...u].every(j=>p.has(j))}else s.type==="text"&&(b=!0);const w=b?f:0;r[s.section]=r[s.section]||{earned:0,total:0},r[s.section].earned+=w,r[s.section].total+=f;for(const u of s.basicTag||[])h[u]=h[u]||{earned:0,total:0},h[u].earned+=w,h[u].total+=f}Object.entries(D).reduce((s,[o,f])=>s+(o==="Hazmat"&&!c?0:f),0);let n=0;for(const[s,o]of Object.entries(h)){if(s===t.HZ&&!c)continue;const f=o.total?o.earned/o.total:0;n+=f*(D[s]||0)}const y=n/(c?100:100-D[t.HZ])*100;return{sections:r,perBasic:h,overallPct:y}}function H({perBasic:g,includeHazmat:c}){const r=[],h=n=>{const y=g[n]||{earned:0,total:0};return y.total?Math.round(y.earned/y.total*100):0};return h(t.HOS)<80&&r.push("HOS <80% → add ELD exception training, supporting docs checklist, and unassigned driving SOP."),h(t.VM)<80&&r.push("Vehicle Maintenance <80% → DVIR refresher, annual inspection reconciliation, and OOS repair tracking."),h(t.DF)<85&&r.push("DQF <85% → audit Clearinghouse queries, prior employer verification, and annual MVR/review cadence."),e.jsxs("ul",{className:"cq-small",children:[r.map((n,y)=>e.jsx("li",{children:n},y)),!r.length&&e.jsx("li",{children:"Great work—keep monitoring monthly CSA/SMS and schedule quarterly internal audits."})]})}function L({companyName:g="Your Company",includeHazmat:c=!1,onClose:r}){const h=`cq.answers.${g}.${c?"hz":"nohz"}`,[n,y]=S.useState(()=>{try{return JSON.parse(localStorage.getItem(h))||{}}catch{return{}}}),[s,o]=S.useState(0),[f,b]=S.useState(!1),w=R(c),u=S.useMemo(()=>T.filter(i=>w.includes(i.section)),[c]),p=u[s];S.useEffect(()=>{localStorage.setItem(h,JSON.stringify(n))},[n]);const j=Math.round(s/u.length*100),v=(i,l)=>y(x=>({...x,[i]:l})),M=()=>{s<u.length-1?o(s+1):b(!0)},k=()=>o(Math.max(0,s-1)),{perBasic:N,overallPct:C}=S.useMemo(()=>A(n,c),[n,c]),O=()=>C>=90?e.jsx("span",{className:"badge ok",children:"Green"}):C>=75?e.jsx("span",{className:"badge warn",children:"Yellow"}):e.jsx("span",{className:"badge bad",children:"Red"}),q=()=>{const i={companyName:g,includeHazmat:c,answers:n,computed:A(n,c),ts:new Date().toISOString()},l=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),x=URL.createObjectURL(l),m=document.createElement("a");m.href=x,m.download=`compliance-quiz-${g.replace(/\s+/g,"-").toLowerCase()}.json`,m.click(),URL.revokeObjectURL(x)},F=()=>window.print(),I=i=>{const l=n[i.id]||(i.type==="multi"?[]:i.type==="text"?"":[]),x=(i.type==="tf"||i.type==="single"||i.type==="multi")&&(Array.isArray(l)?l.length>0:!1);if(i.type==="tf"||i.type==="single")return e.jsx("div",{className:"cq-choices",children:i.choices.map((m,a)=>e.jsxs("label",{className:`cq-choice ${x&&l?.[0]===a?a===i.correct?.[0]?"correct":"wrong":""}`,onClick:()=>v(i.id,[a]),children:[e.jsx("input",{type:"radio",name:i.id,checked:(l?.[0]??-1)===a,onChange:()=>v(i.id,[a])}),e.jsx("span",{children:m}),x&&l?.[0]===a&&e.jsx("span",{className:`cq-flag ${a===i.correct?.[0]?"ok":"bad"}`,children:a===i.correct?.[0]?"Correct":"Try Again"})]},a))});if(i.type==="multi"){const m=a=>{const d=new Set(l);d.has(a)?d.delete(a):d.add(a),v(i.id,[...d].sort())};return e.jsx("div",{className:"cq-choices",children:i.choices.map((a,d)=>e.jsxs("label",{className:`cq-choice ${x&&l.includes(d)?new Set(i.correct||[]).has(d)?"correct":"wrong":""}`,onClick:()=>m(d),children:[e.jsx("input",{type:"checkbox",checked:l.includes(d),onChange:()=>m(d)}),e.jsx("span",{children:a}),x&&l.includes(d)&&e.jsx("span",{className:`cq-flag ${new Set(i.correct||[]).has(d)?"ok":"bad"}`,children:new Set(i.correct||[]).has(d)?"Correct":"Check"})]},d))})}return i.type==="text"?e.jsx("textarea",{rows:3,style:{width:"100%",padding:".5rem"},value:l,onChange:m=>v(i.id,m.target.value),placeholder:"Type your steps/policy here (not graded)"}):null};return e.jsxs("section",{className:"cq-wrap","aria-label":"CMV Company Compliance Quiz",children:[r&&e.jsx("button",{type:"button",className:"cq-close","aria-label":"Close compliance quiz",onClick:r,children:"✕"}),e.jsxs("div",{className:"cq-header",children:[e.jsx("span",{className:"cq-dot","aria-hidden":!0}),e.jsx("h2",{children:"Take the Compliance Quiz"})]}),e.jsx("p",{className:"cq-sub",children:"Quick audit-readiness check mapped to CSA/SMS BASICs. All client-side; progress saved locally."}),f?e.jsxs("div",{className:"cq-results",children:[e.jsx("h3",{children:"Results"}),e.jsxs("div",{className:"cq-badges",children:[e.jsxs("span",{className:"badge neutral",children:["Overall: ",Math.round(C),"%"]}),O()]}),e.jsx("h4",{children:"Action Plan"}),e.jsx(H,{perBasic:N,includeHazmat:c}),e.jsxs("div",{className:"cq-actions",children:[e.jsx("button",{className:"cq-btn",onClick:q,children:"Export JSON"}),e.jsx("button",{className:"cq-btn secondary",onClick:F,children:"Print"}),e.jsx("button",{className:"cq-btn",onClick:()=>{b(!1),o(0)},children:"Retake"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cq-progress",children:[e.jsx("div",{className:"cq-bar",children:e.jsx("span",{style:{width:`${j}%`}})}),e.jsxs("div",{className:"cq-count",children:[s+1," / ",u.length]})]}),e.jsxs("div",{className:"cq-section-head",children:[e.jsx("div",{className:"cq-section-title",children:p.section}),e.jsxs("div",{className:"cq-section-desc",children:[g," ",c?"• Hazmat included":""]})]}),e.jsxs("div",{className:"cq-card",children:[e.jsx("p",{className:"cq-qtext",children:p.text}),I(p)]}),e.jsxs("div",{className:"cq-controls",children:[e.jsx("div",{className:"left",children:e.jsx("button",{className:"cq-btn secondary",onClick:k,disabled:s===0,children:"Back"})}),e.jsxs("div",{className:"right",children:[e.jsx("button",{className:"cq-btn secondary",onClick:()=>b(!0),children:"Skip to Results"}),e.jsx("button",{className:"cq-btn",onClick:M,disabled:p.type==="tf"||p.type==="single"?!(n[p.id]||[]).length:p.type==="multi"?!(n[p.id]||[]).length:!1,children:s<u.length-1?"Next":"Finish"})]})]})]})]})}export{L as default};
